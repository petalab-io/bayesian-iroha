# Bayesian Spatial Modeling: ホッケー・ゴテンダーの真の実力評価

## 1. 背景とビジネス課題
プロスポーツやビジネスの現場において、個人のパフォーマンスを「結果の数字（例：セーブ率、成約率）」だけで評価すると、環境による有利・不利を見落とすリスクがあります。

### 解決したい課題 (ROI/ROPEの視点)
* **公平な評価指標の構築**: 守備の弱いチームで「至近距離のシュートを浴び続けている選手」を、シュート位置の難易度（期待ゴール率）を加味して公平に評価します。
* **意思決定の足切り（ROPE）**: セーブ率の僅かな差が、ビジネス（勝利）に影響を与える「実質的な差」なのか、単なる「運のゆらぎ」なのかを判定します。

---

## 2. 数学的基礎（二段構え解説）
本プロジェクトで採用する階層ベイズモデルの主要な構成要素です。

### ① ベルヌーイ分布 (Bernoulli Distribution)
* **【概念的な定義】**:
    結果が成功（1）か失敗（0）のいずれかになる試行を記述する離散確率分布です。
    $$y_i \sim \text{Bernoulli}(p_i)$$
    $y_i$ は $i$ 番目のシュート結果（ゴール＝1）、$p_i$ はそのシュートが決まる確率を指します。
* **【直感的な理解】**:
    **「イカサマ・コインの判定」**です。シュートが打たれるたびに、その状況の「決まりやすさ」に応じたコインを投げている状態を想像してください。

### ② ロジットリンク関数 (Logit Link Function)
* **【概念的な定義】**:
    確率 $p$（0から1の範囲）を、制限のない実数値（$-\infty$ から $+\infty$）に変換する関数です。
    $$\text{logit}(p_i) = \log\left(\frac{p_i}{1-p_i}\right) = \eta_i$$
    空間モデルから算出された「シュートの危険度 $\eta_i$」を、私たちが理解できる 0%〜100% の確率に変換します。
* **【直感的な理解】**:
    **「光の強さを測る露出計」**です。非常に暗い場所から眩しい場所までを、人間の目に見える「明るさの度合い（0〜100%）」にギュッと押し込めて表示する目盛りのような役割です。

### ③ 空間スプライン (Spatial Splines)
* **【概念的な定義】**:
    座標 $(x, y)$ の滑らかな変化を基底関数の線形結合で表現する手法です。
    $$\eta_i = \alpha + f(x_i, y_i)$$
    ここで $f(x, y)$ が場所ごとの「得点しやすさ」のうねりを表現します。
* **【直感的な理解】**:
    **「リンクの上に敷いたゴムマット」**です。ゴールに近い場所はマットを低く（吸い込まれやすい）、遠い場所は高く（入りにくい）なるように、データに基づいてマットをデコボコさせることで、場所ごとの有利・不利を表現します。



---

## 3. 分析の評価基準（3層フィルタリング）
分析結果は、以下の3段階のフィルタを通して解釈します。

| フィルタ | 評価内容 | 判断基準 |
| :--- | :--- | :--- |
| **1. HDI** | 統計的実証 | 選手の能力差（GSAx）の 94% HDI が 0 を跨いでいないか。 |
| **2. ROPE** | 実質的等価性 | 能力の差が、試合結果に影響しない「誤差レベル（例: ±0.1失点）」を超えているか。 |
| **3. ROI** | 経済的評価 | 防いだ失点数が、勝利給や年俸、観客動員にどう寄与するかを利益分布で算出。 |

---

## 4. 開発規約
* **命名規則**: `[主語]_[修飾語]` のスネークケースを徹底（例: `goal_obs`, `spatial_trend`）。
* **実装手法**: 小規模データにおける発散（Divergences）を防ぐため、**非中心化（Non-centered Parameterization）**を採用。
* **使用ライブラリ**: PyMC v5, ArviZ, Bambi。