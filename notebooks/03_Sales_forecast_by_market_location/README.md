# 階層ベイズ線形回帰によるマルシェ出店地点別の売上予測

## 1. 背景とビジネス課題
マルシェ（移動販売）などのSMB（中小規模ビジネス）において、出店場所の選定は利益を左右する最重要事項です。しかし、過去の実績データは地点ごとに数件（合計12件）と極めて少なく、単純な平均値では「地点の真の実力」と「天候や季節による一時的な変動」を分離できません。

本プロジェクトでは、**階層ベイズ線形回帰モデル**を採用し、小規模データからでも地点ごとのポテンシャルとリスク（不確実性）を正しく評価し、ROI（投資対効果）に基づいた戦略的な判断材料を提供します。

## 2. 数学的基礎（2段構え解説）
本分析の論理的根拠となる主要な概念を解説します。

### 階層ベイズ線形回帰モデル (Hierarchical Bayesian Linear Regression)
個別の観測対象（地点）が持つパラメータが、共通の母集団分布から生成されると仮定する回帰モデル。本モデルでは、地点ごとの売上特性を階層化し、全地点共通のベースラインからの「ズレ」として推定します。

データが少ない地点でも、全体の傾向を「情報の借用（Shrinkage）」として利用することで、極端に外れた予測を防ぎ、安定した評価が可能になります。

### 対数正規分布 (Log-Normal Distribution)
変数 $x$ の対数 $\ln(x)$ が正規分布に従う確率分布。売上のように正の値のみを取り、右側に長い裾（ロングテール）を持つデータのモデリングに適しています。

売上は「客数 × 客単価」のように要素が掛け合わさって決まるため、平均的な日よりも「たまに大爆発する日」が出やすくなります。
この「爆発力」を正しく予測に含めるようにしています。

### 弱情報事前分布 (Weakly Informative Prior)
 パラメータが取り得る妥当な範囲を緩やかに指定する分布（例：$\text{Normal}(0, 0.5^2)$）になります。
 モデルが現実離れした値を探索するのを防ぎ、計算を安定させます。

 分析者が事前に持っている「売上はこのくらいになるはずだ」という緩い知識と、目の前の実績データを数学的に正しく合算（ベイズ更新）します。

## 3. 戦略的インサイト：分析結果と経営判断
分析の結果、2026年2月（冬季）の最適戦略として以下の結論を得ました。

### 意思決定フレームワーク（3層フィルタリング）
1.  **HDI (統計的実証)**: 推定された利益の94%が収まる範囲を算出し、不確実性を可視化。
2.  **ROPE (実質的等価性)**: 実務上の損益分岐点（利益20,000円）を合格ラインとして設定。
3.  **ROI (経済的評価)**: 天候不詳リスクや日々の売上変動をすべて考慮した最終的な利益分布を評価。

### 最終戦略提案
**2026年2月は『B: ParkStreet』への出店が推奨候補になります。**

* **期待利益平均**: **約41,750円**（ROPEの合格ラインを大きく超過）
* **黒字確率（勝率）**: **62.5%**
* **リスク評価**: 冬季の天候リスクを考慮しても、赤字時の損失平均は約13,600円に抑えられる見込みです。
* 一方で、勝った時の期待利益は約75,000円と大きく、経営的に「勝負できる」地点です。

---
※ 詳細な分析プロセス、モデル診断、ソースコードについては `hierarchical_baysian_linear_regression.ipynb` で参照可能です。